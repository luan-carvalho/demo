<div th:fragment="serviceCard" class="card shadow-sm mb-3 border rounded-3 service-card">
    <div class="card-body p-3">

        <!-- Header -->
        <div class="d-flex justify-content-between align-items-center mb-2">
            <h6 class="card-title mb-0 fw-semibold" th:text="${service.pet.name}"></h6>
            <a th:href="@{/serviceExecution/{id}(id=${service.id})}" class="btn btn-sm btn-outline-secondary"
                title="Editar">
                <i class="bi bi-pencil-fill"></i>
            </a>
        </div>

        <!-- Tutor -->
        <p class="card-subtitle mb-2 text-muted small">
            <i class="bi bi-person me-1"></i>
            <span th:text="${service.tutor.name}"></span>
        </p>

        <!-- Services -->
        <div class="mt-3 border-top pt-2">
            <p class="small text-muted mb-1 fw-semibold">Servi√ßos</p>
            <div class="d-flex flex-wrap gap-1 overflow-hidden" style="max-height: 60px;">
                <span th:each="item : ${service.checklist}"
                    class="badge bg-light text-dark border rounded-pill px-2"
                    th:text="${item.petCare.description}"></span>
            </div>
            <div th:if="${#lists.size(service.checklist) > 5}" class="small text-muted mt-1">
                +<span th:text="${#lists.size(service.checklist) - 5}"></span> mais
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="card-footer d-flex justify-content-between align-items-center p-2 bg-light">
        <div>
            <span class="text-muted small">Total:</span>
            <span class="fw-semibold text-dark"
                th:text="'R$ ' + ${#numbers.formatDecimal(service.calculateTotal(), 1, 'POINT', 2, 'COMMA')}"></span>
        </div>

        <div>
            <div th:if="${service.serviceStatus.name() == 'PENDING' and not service.isEmpty()}">
                <form th:action="@{/serviceExecution/{id}/start(id=${service.id})}" method="post" class="d-inline">
                    <button type="submit" class="btn btn-sm btn-primary" title="Iniciar Atendimento">
                        <i class="bi bi-play-fill"></i>
                    </button>
                </form>
            </div>
            <div th:if="${service.serviceStatus.name() == 'IN_PROGRESS'}">
                <form th:action="@{/serviceExecution/{id}/markAsDone(id=${service.id})}" method="post" class="d-inline">
                    <button type="submit" class="btn btn-sm btn-info text-dark" title="Finalizar Atendimento">
                        <i class="bi bi-check-lg"></i>
                    </button>
                </form>
            </div>
            <div th:if="${service.serviceStatus.name() == 'DONE'}">
                <a th:href="@{/serviceExecution/{id}/checkout(id = ${service.id})}" class="btn btn-sm btn-success"
                    title="Registrar Pagamento">
                    <i class="bi bi-currency-dollar"></i>
                </a>
            </div>
        </div>
    </div>
</div>